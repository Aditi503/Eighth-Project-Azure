IF OBJECT_ID('dbo.dim_date') IS NOT NULL
    DROP EXTERNAL TABLE dbo.dim_date;
GO

CREATE EXTERNAL TABLE dbo.dim_date
WITH (
    LOCATION    = 'star_schema/dim_date',
    DATA_SOURCE = eighthproject_ds,
    FILE_FORMAT = SynapseDelimitedTextFormat
)
AS
SELECT DISTINCT
    CAST(start_at AS DATE) AS date_key,
    CAST(start_at AS DATE) AS full_date,
    DAY(start_at)   AS day,
    MONTH(start_at) AS month,
    YEAR(start_at)  AS year
FROM dbo.staging_trips;
GO

SELECT TOP 50 * FROM dbo.dim_date;
