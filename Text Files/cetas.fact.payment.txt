IF OBJECT_ID('dbo.fact_payment') IS NOT NULL
    DROP EXTERNAL TABLE dbo.fact_payment;
GO

CREATE EXTERNAL TABLE dbo.fact_payment
WITH (
    LOCATION    = 'star_schema/fact_payment',
    DATA_SOURCE = eighthproject_ds,
    FILE_FORMAT = SynapseDelimitedTextFormat
)
AS
SELECT
    payment_id,                             
    amount,                                 
    CAST(payment_date AS DATETIME2) AS payment_date,
    rider_id AS rider_key,                  
    CAST(payment_date AS DATE) AS date_key  
FROM dbo.staging_payments;
GO

SELECT TOP 50 * FROM dbo.fact_payment;
